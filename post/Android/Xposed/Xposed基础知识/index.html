<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>Xposed基础知识 | Kernweak&#39;s Blog</title>
    <meta property="og:title" content="Xposed基础知识 - Kernweak&#39;s Blog">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2021-01-02T15:39:13&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2021-01-02T15:39:13&#43;08:00'>
        
    <meta name="Keywords" content="reverse,PC,android">
    <meta name="description" content="Xposed基础知识">
        
    <meta name="author" content="Kernweak">
    <meta property="og:url" content="https://kernweak.github.io/post/Android/Xposed/Xposed%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://kernweak.github.io/">
                        Kernweak&#39;s Blog
                    </a>
                
                <p class="description">security engineer</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://kernweak.github.io/">首页</a>
                    
                    <a  href="https://kernweak.github.io/tools/" title="工具">工具</a>
                    
                    <a  href="https://kernweak.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="https://kernweak.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#xposed插件编写">Xposed插件编写</a>
      <ul>
        <li><a href="#2xposed插件编写">2.Xposed插件编写</a></li>
        <li><a href="#新建hook类编写hook代码">新建hook类，编写hook代码</a></li>
        <li><a href="#新建assets文件夹在assets目录下新建文件xposed_init在里面写上hook类的完整路径">新建assets文件夹，在assets目录下新建文件xposed_init,在里面写上hook类的完整路径</a></li>
      </ul>
    </li>
    <li><a href="#xposed的hook构造函数">xposed的hook构造函数</a></li>
  </ul>

  <ul>
    <li><a href="#使用java反射完成对类函数的调用">使用java反射完成对类函数的调用</a>
      <ul>
        <li><a href="#静态函数主动调用">静态函数主动调用</a></li>
        <li><a href="#非静态函数主动调用">非静态函数主动调用</a></li>
      </ul>
    </li>
    <li><a href="#使用xposed的api操作">使用Xposed的API操作</a></li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">Xposed基础知识</h1>
        </header>
        <date class="post-meta meta-date">
            2021年1月2日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="xpose原理">Xpose原理</h1>
<p>控制zygote进程，通过替换/system/bin/app_precess程序控制zygote进程，使它在系统启动过程中加载Xposed framework的一个jar文件即XposedBridge.jar,从而完成对Zygote进程及创建的Dalvik/ART虚拟机的劫持，并且能够允许开发者独立替代任何class，例如framework本身，系统UI或者随意一个app。<br>
控制程序两种方式，通过attach之后ptrace调试器，通过定制rom。</p>
<h1 id="xpose安装">Xpose安装</h1>
<p>Android5.0以后：<br>
1.对手机root，刷入recovery。<br>
下载对应zip补丁包。<br>
重启手机安装xposedinstaller并授予root权限。<br>
<a href="https://note.youdao.com/">http://dl-xda.xposed.info/framework/</a><br>
关于zip下载：<br>

        <img class="mx-auto" alt="image" src="BA4D2CD9F173402386A8C296004EA9BC" />   
    <br>
根据系统版本去下载。比如6以后就是ARM64。<br>
以N5，6.0为例。<br>
首先需要解锁bootloader，刷hammerhead的rom<br>
如果出现Writing &lsquo;userdata&rsquo; FAILED (remote: &lsquo;Bogus size sparse and chunk header&rsquo;)则先执行：flash-base.sh<br>
然后将image-hammerhead-mmb29s.zip解压到某个文件夹，紧接着创建一个在文件夹中创建一个flash-image.bat，里面写入：</p>
<pre><code>@echo off
::正常开机模式
::adb reboot bootloader
::reboot模式
fastboot reboot-bootloader
ping -n 15 127.0.0.1 &gt;nul
::fastboot oem unlock
fastboot erase system
fastboot erase boot
fastboot erase recovery
fastboot erase cache
fastboot erase userdata
fastboot flash system system.img
fastboot flash boot boot.img
fastboot flash recovery recovery.img
fastboot flash cache cache.img
fastboot flash userdata userdata.img
pause
fastboot reboot
</code></pre><p>执行此bat，则刷机成功。<br>
然后刷recovery，比如</p>
<pre><code>C:\Users\ThinkPad&gt;fastboot flash recovery C:\Users\ThinkPad\Desktop\n5_6.0\twrp-3.2.2-0-hammerhead.img
</code></pre><p>进入recovery，n5这里直接手机选择进入（点击音量，到recovery再进入）。<br>
然后拷入supersu和xposed。<br>
再安装Xposed。<br>
如果是高于xpose的版本，就要结合edxposed和magisk。<br>
注意高版本9.0不要设置密码，不然twrp，recovery时要输入密码，而且输设置的也不对。<br>
然后就是安装twrp-&gt;Magisk-&gt;EdXposed-SandHook-&gt;EdXposedManager。</p>
<h1 id="xposed插件开发之hook构造函数">Xposed插件开发之hook构造函数</h1>
<h2 id="xposed插件编写">Xposed插件编写</h2>
<ol>
<li>拷贝XposedBridgeApi.jar到新建工程的libs目录。</li>
<li>修改app目录下的build.gradle文件，在androidManifest.xml中增加Xpose的相关内容。</li>
<li>新建hook类，编写hook代码</li>
<li>新建assets文件夹，在assets目录下新建文件xposed_init,在里面写上hook类的完整路径。</li>
</ol>
<h3 id="2xposed插件编写">2.Xposed插件编写</h3>
<pre><code>    &lt;meta-data android:name=&quot;xposedmodule&quot;
            android:value=&quot;true&quot;/&gt;
        &lt;meta-data android:name=&quot;xposeddescription&quot;
            android:value=&quot;模块描述&quot;/&gt;
        &lt;meta-data android:name=&quot;xposedminversion&quot;
            android:value=&quot;54&quot;/&gt;
        
</code></pre><h3 id="新建hook类编写hook代码">新建hook类，编写hook代码</h3>
<p>
        <img class="mx-auto" alt="image" src="53A9934C528A43D08A15C2610DFF84B2" />   
    </p>
<h3 id="新建assets文件夹在assets目录下新建文件xposed_init在里面写上hook类的完整路径">新建assets文件夹，在assets目录下新建文件xposed_init,在里面写上hook类的完整路径</h3>
<p>res文件夹下新建assets文件夹，在assets目录下新建文件xposed_init,在里面写上hook类的完整路径，里面内容为实现了IXposedHookLoadPackage接口的hook类的完整类名（可以有多个，每一个hook实现类一行）<br>

        <img class="mx-auto" alt="image" src="544F91A97D884A1B9FBE62D6AF0A4F54" />   
    </p>
<h2 id="xposed的hook构造函数">xposed的hook构造函数</h2>
<p>首先是通过jadx确定包名，类名，方法名，接着使用
两个，如下，第一个需要类型，可以通过classload加载。第二个需要传入类名，ClassLoader。
然后紧接着的参数为遍参的构造函数参数，最后一个为修改构造函数的回调函数。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">   <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Unhook <span style="color:#900;font-weight:bold">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span>Class<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">?</span><span style="color:#000;font-weight:bold">&gt;</span> clazz<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">.</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000;font-weight:bold">.</span> parameterTypesAndCallback<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>parameterTypesAndCallback<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">length</span> <span style="color:#000;font-weight:bold">!</span><span style="color:#000;font-weight:bold">=</span> 0 <span style="color:#000;font-weight:bold">&amp;</span><span style="color:#000;font-weight:bold">&amp;</span> parameterTypesAndCallback<span style="color:#000;font-weight:bold">[</span>parameterTypesAndCallback<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">length</span> <span style="color:#000;font-weight:bold">-</span> 1<span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">instanceof</span> XC_MethodHook<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            XC_MethodHook callback <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>XC_MethodHook<span style="color:#000;font-weight:bold">)</span>parameterTypesAndCallback<span style="color:#000;font-weight:bold">[</span>parameterTypesAndCallback<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">length</span> <span style="color:#000;font-weight:bold">-</span> 1<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
            Constructor<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">?</span><span style="color:#000;font-weight:bold">&gt;</span> m <span style="color:#000;font-weight:bold">=</span> findConstructorExact<span style="color:#000;font-weight:bold">(</span>clazz<span style="color:#000;font-weight:bold">,</span> getParameterClasses<span style="color:#000;font-weight:bold">(</span>clazz<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getClassLoader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">,</span> parameterTypesAndCallback<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#000;font-weight:bold">return</span> XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hookMethod</span><span style="color:#000;font-weight:bold">(</span>m<span style="color:#000;font-weight:bold">,</span> callback<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> IllegalArgumentException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;no callback defined&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>

    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Unhook <span style="color:#900;font-weight:bold">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span>String className<span style="color:#000;font-weight:bold">,</span> ClassLoader classLoader<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">.</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000;font-weight:bold">.</span> parameterTypesAndCallback<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">return</span> findAndHookConstructor<span style="color:#000;font-weight:bold">(</span>findClass<span style="color:#000;font-weight:bold">(</span>className<span style="color:#000;font-weight:bold">,</span> classLoader<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">,</span> parameterTypesAndCallback<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
    <span style="color:#000;font-weight:bold">}</span>
</code></pre></td></tr></table>
</div>
</div><p>另外MethodHookParam参数里，获取类的返回值是this.object，不是result。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#998;font-style:italic">// public Object thisObject;
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// public Object[] args;
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// private Object result = null;
</span></code></pre></td></tr></table>
</div>
</div><p>以下是hook各种参数构造函数的代码实例：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-JAVA" data-lang="JAVA"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">HookConstructors</span> <span style="color:#000;font-weight:bold">implements</span> IXposedHookLoadPackage <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">handleLoadPackage</span><span style="color:#000;font-weight:bold">(</span>XC_LoadPackage<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">LoadPackageParam</span> loadPackageParam<span style="color:#000;font-weight:bold">)</span>
            <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
        Log<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">i</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Xposed01&#34;</span><span style="color:#000;font-weight:bold">,</span>loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">packageName</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
        XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;app packagename&#34;</span><span style="color:#000;font-weight:bold">+</span>loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">packageName</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">packageName</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">equals</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.xposedhook01&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
            XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;hookConstructors&#34;</span> <span style="color:#000;font-weight:bold">+</span> loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">packageName</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>

            ClassLoader classLoader <span style="color:#000;font-weight:bold">=</span> loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">classLoader</span><span style="color:#000;font-weight:bold">;</span>
            Class StudentClass<span style="color:#000;font-weight:bold">=</span>classLoader<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">loadClass</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.xposedhook01.Student&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span><span style="color:#998;font-style:italic">//
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//Student()
</span><span style="color:#998;font-style:italic"></span>            XposedHelpers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span>StudentClass<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">new</span> XC_MethodHook<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student() is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student() is called!after HookConstructor&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#998;font-style:italic">//public Student(String name2)
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">// public Object thisObject;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        public Object[] args;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        private Object result = null;
</span><span style="color:#998;font-style:italic"></span>            XposedHelpers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span>StudentClass<span style="color:#000;font-weight:bold">,</span> String<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">new</span> XC_MethodHook<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                    java<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Object</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000;font-weight:bold">]</span> argobjarry<span style="color:#000;font-weight:bold">=</span>param<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">args</span><span style="color:#000;font-weight:bold">;</span>
                    String name<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>0<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>

                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34; student name is &#34;</span><span style="color:#000;font-weight:bold">+</span>name<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>

                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#998;font-style:italic">//  public Student(String name,String id)
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//    {
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        this.name = name;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        this.id = id;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//    }
</span><span style="color:#998;font-style:italic"></span>            XposedHelpers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span>StudentClass<span style="color:#000;font-weight:bold">,</span> String<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> String<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">new</span> XC_MethodHook<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                    java<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Object</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000;font-weight:bold">]</span> argobjarry<span style="color:#000;font-weight:bold">=</span>param<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">args</span><span style="color:#000;font-weight:bold">;</span>
                    String name<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>0<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
                    String id<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>1<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String,String) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34; student name is &#34;</span><span style="color:#000;font-weight:bold">+</span>name<span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34; id is&#34;</span><span style="color:#000;font-weight:bold">+</span>id<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>

                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String,String) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
            <span style="color:#998;font-style:italic">//  public Student(String name,String id,int age)
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//    {
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        this.name = name;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        this.id = id;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//        this.age = age;
</span><span style="color:#998;font-style:italic"></span>            <span style="color:#998;font-style:italic">//    }
</span><span style="color:#998;font-style:italic"></span>           <span style="color:#998;font-style:italic">/* XposedHelpers.findAndHookConstructor(StudentClass, String.class, String.class,int.class , new XC_MethodHook() {
</span><span style="color:#998;font-style:italic">                @Override
</span><span style="color:#998;font-style:italic">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
</span><span style="color:#998;font-style:italic">                    super.beforeHookedMethod(param);
</span><span style="color:#998;font-style:italic">                    java.lang.Object[] argobjarry=param.args;
</span><span style="color:#998;font-style:italic">                    String name=(String)argobjarry[0];
</span><span style="color:#998;font-style:italic">                    String id=(String)argobjarry[1];
</span><span style="color:#998;font-style:italic">                    int age=(int)argobjarry[2];
</span><span style="color:#998;font-style:italic">                    XposedBridge.log(&#34;com.yrq.XposedHook01.Student(String,String,int) is called!Before HookConstructor&#34;+&#34; student name is &#34;+name+&#34; id is&#34;+id+&#34;age &#34;+age);
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">                }
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">                @Override
</span><span style="color:#998;font-style:italic">                protected void afterHookedMethod(MethodHookParam param) throws Throwable {
</span><span style="color:#998;font-style:italic">                    super.afterHookedMethod(param);
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">                    XposedBridge.log(&#34;com.yrq.XposedHook01.Student(String,String,int) is called!Before HookConstructor&#34;);
</span><span style="color:#998;font-style:italic">                }
</span><span style="color:#998;font-style:italic">            });
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">            */</span>
            XposedHelpers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAndHookConstructor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.xposedhook01.Student&#34;</span><span style="color:#000;font-weight:bold">,</span>loadPackageParam<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">classLoader</span><span style="color:#000;font-weight:bold">,</span>String<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> String<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">new</span> XC_MethodHook<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beforeHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                    java<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Object</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000;font-weight:bold">]</span> argobjarry<span style="color:#000;font-weight:bold">=</span>param<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">args</span><span style="color:#000;font-weight:bold">;</span>

                    <span style="color:#458;font-weight:bold">int</span> age<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>2<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
                    argobjarry<span style="color:#000;font-weight:bold">[</span>1<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;9547&#34;</span><span style="color:#000;font-weight:bold">;</span>
                    argobjarry<span style="color:#000;font-weight:bold">[</span>0<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;gecong&#34;</span><span style="color:#000;font-weight:bold">;</span>
                    String name<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>0<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
                    String id<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span>argobjarry<span style="color:#000;font-weight:bold">[</span>1<span style="color:#000;font-weight:bold">]</span><span style="color:#000;font-weight:bold">;</span>
                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String,String,int) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34; student name is &#34;</span><span style="color:#000;font-weight:bold">+</span>name<span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34; id is&#34;</span><span style="color:#000;font-weight:bold">+</span>id<span style="color:#000;font-weight:bold">+</span><span style="color:#d14">&#34;age &#34;</span><span style="color:#000;font-weight:bold">+</span>age<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>

                <span style="color:#000;font-weight:bold">}</span>

                <span style="color:#3c5d5d;font-weight:bold">@Override</span>
                <span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>MethodHookParam param<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
                    <span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">afterHookedMethod</span><span style="color:#000;font-weight:bold">(</span>param<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>

                    XposedBridge<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;com.yrq.XposedHook01.Student(String,String,int) is called!Before HookConstructor&#34;</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
                <span style="color:#000;font-weight:bold">}</span>
            <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">;</span>
        <span style="color:#000;font-weight:bold">}</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="xposed插件开发之修改属性">Xposed插件开发之修改属性</h1>
<p>前面的方法是通过hook类的构造函数，修改变量，现在是通过类或者对象，修改类或者对象的属性。</p>
<ol>
<li>使用java反射修改属性</li>
<li>使用Xposed的API修改属性<br>
第一种生成的hook类也是运行在当前进程的用户空间的，跟app自己的dex也都是在一起的，所以可用反射。<br>
注意点如果使用第一种使用java反射修改属性，非public时修改前不设置取消权限修改会报错，第二种使用Xposed的API修改属性则正常</li>
</ol>
<pre><code>  teacherField.setAccessible(true);
</code></pre><h1 id="课时4xposed插件开发之hook一般函数">课时4：Xposed插件开发之hook一般函数</h1>
<ul>
<li>一般Java函数的hook</li>
<li>内部类中函数的hook</li>
<li>匿名内部类函数的hook</li>
<li>类中JNI函数的hook</li>
</ul>
<p>都可用findAndHookMethod。</p>
<h1 id="xposed插件开发之主动调用类函数">Xposed插件开发之主动调用类函数</h1>
<ol>
<li>使用java反射完成对类函数的调用</li>
<li>使用Xposed的API完成对类函数的调用</li>
</ol>
<h2 id="使用java反射完成对类函数的调用">使用java反射完成对类函数的调用</h2>
<p>对于类中静态函数，直接调用即可<br>
对于非静态函数需要先得到实例，再调用</p>
<h3 id="静态函数主动调用">静态函数主动调用</h3>
<p>对于类中静态函数，关于public和private的Xposed主动调用区别是private要关闭权限检查即</p>
<blockquote>
<p>.setAccessible(true);</p>
</blockquote>
<pre><code>public class HookActiveInvoke implements IXposedHookLoadPackage {
    @Override
    public void handleLoadPackage(XC_LoadPackage.LoadPackageParam loadPackageParam)
            throws Throwable {
        Log.i(&quot;Xposed01&quot;,loadPackageParam.packageName);
        XposedBridge.log(&quot;app packagename&quot;+loadPackageParam.packageName);
        if (loadPackageParam.packageName.equals(&quot;com.yrq.xposedhook01&quot;)) {
            XposedBridge.log(&quot;YRQ&quot; + loadPackageParam.packageName);

            //使用反射完成对静态函数的调用
            //  public static String publicstaticfunc(String arg1,int arg2){
            //        String result=privatestaticfunc(&quot;privatestaticfunc&quot;,99);
            //        Log.i(&quot;Xposed&quot;,&quot;publicstaticfunc is called&quot;);
            //        return arg1+&quot;---&quot;+arg2+&quot;---&quot;+result;
            //    }
            ClassLoader classLoader=loadPackageParam.classLoader;
            Class StudentCLass=classLoader.loadClass(&quot;com.yrq.xposedhook01.Student&quot;);

            Method publicstaticfunc_Method=StudentCLass.getDeclaredMethod(&quot;publicstaticfunc&quot;,String.class,int.class);
            publicstaticfunc_Method.invoke(null,&quot;publicstaticfunc_Method InvokeByXposed&quot;,100);
            //    private static String privatestaticfunc(String arg1,int arg2){
            //        Log.i(&quot;Xposed&quot;,&quot;privatestaticfunc is called&quot;);
            //        return arg1+&quot;---&quot;+arg2;
            //    }

            
            Method privatestaticfunc_Method=StudentCLass.getDeclaredMethod(&quot;privatestaticfunc&quot;,String.class,int.class);
            privatestaticfunc_Method.setAccessible(true);
            privatestaticfunc_Method.invoke(null,&quot;privatestaticfunc_Method InvokeByXposed&quot;,101);
        }
    }
}
</code></pre><h3 id="非静态函数主动调用">非静态函数主动调用</h3>
<p>使用反射，得到对象后调用</p>
<pre><code> //非静态需要得到对象然后调用
            Method publicfunc_Method=StudentCLass.getDeclaredMethod(&quot;publicfunc&quot;,String.class,int.class);

            //要得到对象，就通过反射，得到构造函数，调用创建实例对象
            //public Student(String name,String id)
            //    {
            //        this.name = name;
            //        this.id = id;
            //    }

            Constructor StuCon=StudentCLass.getDeclaredConstructor(String.class,String.class);
            Object StuObj=StuCon.newInstance(&quot;InstanceByXposed&quot;,&quot;112233&quot;);

            publicfunc_Method.invoke(StuObj,&quot;publicfuncInvockedByXposed&quot;,332211);
            //    private String privatefunc(String arg1,int arg2){
            //        Log.i(&quot;Xposed&quot;,&quot;privatefunc is called!---&quot;+arg1+&quot;---&quot;+arg2);
            //        return arg1+&quot;---&quot;+arg2;
            //    }

            Method privatefunc_Method=StudentCLass.getDeclaredMethod(&quot;privatefunc&quot;,String.class,int.class);

            privatefunc_Method.setAccessible(true);
            String privatefunc_result= (String) publicfunc_Method.invoke(StuObj,&quot;privatefuncInvockedByXposed&quot;,333333);

            XposedBridge.log(&quot;privatefunc activeInvokeByXposed&quot;+privatefunc_result);
</code></pre><h2 id="使用xposed的api操作">使用Xposed的API操作</h2>
<p>XposedHelpers.callStaticMethod()来调用，有两个此函数，区别为有一个有指定参数列表，实现重载的函数调用</p>
<pre><code>    java.lang.Class&lt;?&gt;[]parameterTypes={String.class,int.class};
            XposedHelpers.callStaticMethod(StudentCLass,&quot;publicstaticfunc&quot;,parameterTypes,&quot;XposedHelpers.callStaticMethod&quot;,101);


            Object objStudentByXposed=XposedHelpers.newInstance(StudentCLass,&quot;XposedHelpers.newInstance&quot;,&quot;444444&quot;);
            String result1=(String)XposedHelpers.callMethod(objStudentByXposed,&quot;publicfunc&quot;,&quot;publicfunc is call by XposedHelpers.callMethod&quot;,123);
            XposedBridge.log(&quot;publicfunc XposedHelpers.callMethod result----&quot;+result1);

        }
    }
</code></pre><p>假如是已经有对象了，已经实例化了。一种思路是hook构造函数，就可以通过参数拿到thisobject</p>
<pre><code> XposedHelpers.findAndHookConstructor(StudentCLass, String.class, String.class, new XC_MethodHook() {
                @Override
                protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
                    super.beforeHookedMethod(param);
                    XposedBridge.log(&quot;Student(String,String) is called beforeHookMethod&quot;);
                }

                @Override
                protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                    super.afterHookedMethod(param);
                    Object cstudent=param.thisObject;
                    String result3=(String)XposedHelpers.callMethod(cstudent,&quot;privatefunc&quot;,&quot;cstudent privatefunc&quot;,8888);
                    XposedBridge.log(result3);

                }
            });
</code></pre><p>另一种思路是观察，如果都调用了某个非静态函数，就对这个函数Hook，就可以得到他的对象，然后调用对象的其他函数。</p>
<pre><code>XposedHelpers.findAndHookMethod(StudentCLass, &quot;getNickname&quot;, new XC_MethodHook() {
                @Override
                protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
                    super.beforeHookedMethod(param);
                    Object obj =param.thisObject;
                    XposedHelpers.callMethod(obj,&quot;publicfunc&quot;,&quot;publicfunc is callec by getNickname &quot;,7766);
                    XposedBridge.log(&quot;getNickname beforeHookedMethod-&gt;&quot;+obj);

                }

                @Override
                protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                    super.afterHookedMethod(param);
                    Object obj =param.thisObject;

                    XposedHelpers.callMethod(obj,&quot;publicfunc&quot;,&quot;publicfunc is callec by getNickname &quot;,7766);

                    XposedBridge.log(&quot;getNickname afterHookedMethod-&gt;&quot;+obj);

                }
            });
</code></pre>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://kernweak.github.io/">Kernweak</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://kernweak.github.io/post/Android/Xposed/Xposed%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">https://kernweak.github.io/post/Android/Xposed/Xposed%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        


        <div class="post-meta meta-tags">
            
            没有标签
            
        </div>
    </article>
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "your github repo"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2021 <a href="https://kernweak.github.io/">Kernweak&#39;s Blog By Kernweak</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://kernweak.github.io/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://kernweak.github.io/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://kernweak.github.io/post/Android/Xposed/Xposed%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="Xposed基础知识">Xposed基础知识</a>
    </li>
    
</ul>
    </section>

    
<section class="widget">
    <h3 class="widget-title" style="color:red">福利派送</h3>
    <ul class="widget-list">
        
        <li>
            <a href="https://www.aliyun.com/minisite/goods?userCode=jdg9oj97&amp;share_source=copy_link" title="【2019双12】ALL IN CLoud 低至1折" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1_rYHo7P2gK0jSZPxXXacQpXa-690-388.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://cloud.tencent.com/act/cps/redirect?redirect=1048&amp;cps_key=14ff722692ac784fa8c3301c8c28d924&amp;from=console" title="助力产业智慧升级，云服务器首年88元起，更有千元代金券礼包免费领！" target="_blank" style="color:red">
                
                    <img src="https://upload-dianshi-1255598498.file.myqcloud.com/345-7c71532bd4935fbdd9a67c1a71e577b1767b805c.200%E7%89%88%E6%9C%ACB.jpg">
                
            </a>
        </li>
        
        <li>
            <a href="https://www.aliyun.com/acts/limit-buy?userCode=jdg9oj97" title="【渠道专享低折扣】11月特惠 限时2折" target="_blank" style="color:red">
                
                    <img src="https://img.alicdn.com/tfs/TB1hblJl7Y2gK0jSZFgXXc5OFXa-750-400.jpg">
                
            </a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://blog.csdn.net/youyou519" title="csdn的博客">csdn的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://kernweak.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>